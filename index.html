<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>math.js | plot</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/12.4.1/math.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-1.35.2.min.js"></script>

    <style>
        input[type=text] {
            width: 300px;
        }

        input {
            padding: 6px;
        }

        body,
        html,
        input {
            font-family: sans-serif;
            font-size: 11pt;

        }

        form {
            margin: 20px 0;
        }
    </style>
</head>

<body>

    <form id="form">
        <label for="eq">Enter an equation:</label>
        <input type="text" id="eq" value="4 * sin(x) + 5 * cos(x/2)" />
        <input type="submit" value="Draw" />
    </form>

    <div id="plot"></div>

    <script>
        const xMin = -10.0;
        const xMax = 10.0;

        function draw() {
            try {
                const delta = 0.05;

                const expression = document.getElementById('eq').value
                const expr = math.compile(expression)

                // Calculate the plot points.
                const xValues = math.range(xMin, xMax, delta).toArray()
                const yValues = xValues.map(function (x) {
                    return expr.evaluate({ x: x })
                })

                // Render the plot.
                const funcData = {
                    x: xValues,
                    y: yValues,
                    type: 'scatter',
                    name: 'Function'
                }
                const roots = {
                    x: [-3.1415, 3.14159],
                    y: [0, 0],
                    type: 'scatter',
                    mode: 'markers',
                    name: 'Roots'
                }
                const extrema = {
                    x: [1.208],
                    y: [7.855],
                    type: 'scatter',
                    mode: 'markers',
                    name: 'Extrema'
                }
                const data = [funcData, roots, extrema];
                var layout = {
                    xaxis: {
                        autorange: false
                    },
                    yaxis: {
                        autorange: true
                    }
                };
                Plotly.newPlot('plot', data)
            }
            catch (err) {
                console.error(err)
                alert(err)
            }
        }

        document.getElementById('form').onsubmit = function (event) {
            event.preventDefault()
            draw()
        }

        draw()
    </script>

</body>

</html>